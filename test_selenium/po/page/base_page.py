from selenium import webdriver
from selenium.webdriver.remote.webdriver import WebDriver
class BasePage():
    def __init__(self,base_driver=None):
        base_driver:WebDriver
        # opt = webdriver.ChromeOptions()
        # opt.debugger_address = '127.0.0.1:9222'
        if base_driver is None:
            #self.driver = webdriver.Chrome(executable_path='E:\code\Hogwarts-homework-python\chromedriver.exe',chrome_options=opt)
            self.driver = webdriver.Chrome(executable_path='E:\code\Hogwarts-homework-python\chromedriver.exe')
            self.driver.get('https://work.weixin.qq.com/wework_admin/loginpage_wx?')
            cookies=[{'domain': '.work.weixin.qq.com', 'httpOnly': True, 'name': 'wwrtx.vst', 'path': '/', 'secure': False, 'value': 'u0H3G3Ejfkq1zTHeCZ4ISRIhJd--JJLxRoY3Z2-DXqXC3Cexo9RbuN6-Nwd4hW_HmHyEwWIpTyom5zpve14i_-Y8K1aLs9f0tSVgUZCZJOqH4JRK6FF1xnpcryMSlXpc7q8hD68z-lPcdSTGFcJxO7c0TIOoR70UqbmcVGviqMNbz6Gc9rRJzXsmZgWyxupUm2uXiaBThXSN4O--byxR6h9pSiEFSsfWXpUNNsxALCTK3TGiibJdcOzw-8LCsYrJR5uBJORw2BD1F6R0N6TeNA'}, {'domain': '.work.weixin.qq.com', 'httpOnly': True, 'name': 'wwrtx.sid', 'path': '/', 'secure': False, 'value': 'gT0Ejo9JZh-g_G9j3EgvvboXXF3IjOFAqD68nYN_HjlbXoOO8CerdPG6gDespHoe'}, {'domain': '.work.weixin.qq.com', 'httpOnly': False, 'name': 'wwrtx.d2st', 'path': '/', 'secure': False, 'value': 'a1914286'}, {'domain': '.work.weixin.qq.com', 'httpOnly': False, 'name': 'wwrtx.vid', 'path': '/', 'secure': False, 'value': '1688853808042141'}, {'domain': '.work.weixin.qq.com', 'httpOnly': False, 'name': 'wxpay.vid', 'path': '/', 'secure': False, 'value': '1688853808042141'}, {'domain': '.work.weixin.qq.com', 'httpOnly': False, 'name': 'wxpay.corpid', 'path': '/', 'secure': False, 'value': '1970324949208834'}, {'domain': '.work.weixin.qq.com', 'httpOnly': True, 'name': 'wwrtx.refid', 'path': '/', 'secure': False, 'value': '10650750561414274'}, {'domain': 'work.weixin.qq.com', 'expiry': 1608804266, 'httpOnly': True, 'name': 'ww_rtkey', 'path': '/', 'secure': False, 'value': '8ur1tde'}, {'domain': '.qq.com', 'expiry': 1608875591, 'httpOnly': False, 'name': '_gid', 'path': '/', 'secure': False, 'value': 'GA1.2.1275016766.1608772732'}, {'domain': '.qq.com', 'expiry': 1671861191, 'httpOnly': False, 'name': '_ga', 'path': '/', 'secure': False, 'value': 'GA1.2.1528606747.1608626142'}, {'domain': '.work.weixin.qq.com', 'expiry': 1640162138, 'httpOnly': False, 'name': 'wwrtx.c_gdpr', 'path': '/', 'secure': False, 'value': '0'}, {'domain': '.work.weixin.qq.com', 'expiry': 1611381206, 'httpOnly': False, 'name': 'wwrtx.i18n_lan', 'path': '/', 'secure': False, 'value': 'zh'}, {'domain': '.work.weixin.qq.com', 'httpOnly': True, 'name': 'wwrtx.ltype', 'path': '/', 'secure': False, 'value': '1'}, {'domain': '.work.weixin.qq.com', 'httpOnly': True, 'name': 'wwrtx.ref', 'path': '/', 'secure': False, 'value': 'direct'}, {'domain': '.qq.com', 'expiry': 2147385600, 'httpOnly': False, 'name': 'pgv_pvid', 'path': '/', 'secure': False, 'value': '8712643712'}, {'domain': '.qq.com', 'expiry': 1901071193, 'httpOnly': False, 'name': 'pac_uid', 'path': '/', 'secure': False, 'value': '0_5e84085a92331'}, {'domain': '.qq.com', 'expiry': 2147483648, 'httpOnly': False, 'name': 'ptcz', 'path': '/', 'secure': False, 'value': '5f1386c6b8080ebfb2524cb3cc20835bf34da76da91bae89de4d78759f8e13a3'}, {'domain': '.qq.com', 'expiry': 2147483646, 'httpOnly': False, 'name': 'RK', 'path': '/', 'secure': False, 'value': 'mzR9mwwYG1'}, {'domain': '.qq.com', 'expiry': 1608789238, 'httpOnly': False, 'name': '_gat', 'path': '/', 'secure': False, 'value': '1'}, {'domain': '.qq.com', 'expiry': 2147385600, 'httpOnly': False, 'name': 'pgv_pvi', 'path': '/', 'secure': False, 'value': '9556337664'}]
            for cookie in cookies:
                self.driver.add_cookie(cookie)
            self.driver.get('https://work.weixin.qq.com/wework_admin/frame#index')
        else:
            self.driver=base_driver
        self.driver.implicitly_wait(10)